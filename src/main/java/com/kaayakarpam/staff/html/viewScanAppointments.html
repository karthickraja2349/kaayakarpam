<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kaayakarpam - Appointment</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
      background-color: #f5f7f9;
      color: #333;
      line-height: 1.6;
      display: flex;
      min-height: 100vh;
    }

    /* Sidebar */
      nav {
      width: 240px;
      background-color: #2c3e50;
      padding: 20px 10px;
      box-shadow: 2px 0 5px rgba(0,0,0,0.1);
    }

    nav h2 {
      color: #ecf0f1;
      text-align: center;
      margin-bottom: 25px;
      font-size: 22px;
      margin-top:15px;
      margin-left : 20px;
    }

    nav a {
      display: flex;
      align-items: center;
      color: #ecf0f1;
      text-decoration: none;
      margin: 6px 0; /* Reduced from 12px to 6px */
    padding: 8px 12px; /* Reduced padding from 10px to 8px */
      border-radius: 6px;
      transition: 0.3s;
      font-size: 15px;
    }

    nav a i {
      margin-right: 10px;
      width: 20px;
      text-align: center;
    }

    nav a:hover {
      background-color: #1abc9c;
      color: #fff;
    }


    .main {
      flex: 1;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    
    header {
      background-color: #2c3e50;
      color: white;
      padding: 20px;
      font-size: 24px;
      font-weight: 600;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .container {
      flex: 1;
      padding: 20px;
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      align-items: flex-start;
      justify-content: center;
    }
    
    .card {
      background: white;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      padding: 25px;
      width: 100%;
      max-width: 500px;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 6px 12px rgba(0,0,0,0.15);
    }
    
    .card h2 {
      color: #2c3e50;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 2px solid #1abc9c;
      font-size: 22px;
    }
    
    .info {
      margin-bottom: 15px;
      display: flex;
      align-items: center;
    }
    
    .highlight {
      font-weight: 600;
      color: #2c3e50;
      min-width: 160px;
      display: inline-block;
    }
    
    .error {
      text-align: center;
      padding: 20px;
      color: #e74c3c;
      font-weight: 500;
      font-size: 18px;
    }
    
    /* Status indicators */
    .status {
      display: inline-block;
      padding: 5px 10px;
      border-radius: 20px;
      font-size: 14px;
      font-weight: 500;
      margin-top: 10px;
    }
    
    .status-pending {
      background-color: #ffeaa7;
      color: #d35400;
    }
    
    .status-confirmed {
      background-color: #d1f7c4;
      color: #27ae60;
    }
    
    .status-completed {
      background-color: #cfd8e6;
      color: #2c3e50;
    }
    
    /* Time and date styling */
    .datetime {
      background-color: #f8f9fa;
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
    }
    
    .datetime div {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
    }
    
    /* Action buttons */
    .actions {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
      gap: 10px;
    }
    
    .btn {
      padding: 10px 15px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s;
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    
    .btn-primary {
      background-color: #3498db;
      color: white;
    }
    
    .btn-primary:hover {
      background-color: #2980b9;
    }
    
    .btn-success {
      background-color: #2ecc71;
      color: white;
    }
    
    .btn-success:hover {
      background-color: #27ae60;
    }
    
    .btn-danger {
      background-color: #e74c3c;
      color: white;
    }
    
    .btn-danger:hover {
      background-color: #c0392b;
    }
    
    /* Responsive design */
    @media (max-width: 768px) {
      body {
        flex-direction: column;
      }
      
      nav {
        width: 100%;
        height: auto;
        padding: 10px;
      }
      
      nav h2 {
        margin-bottom: 15px;
        font-size: 20px;
      }
      
      .container {
        padding: 15px;
      }
      
      .card {
        padding: 20px;
      }
      
      .info {
        flex-direction: column;
        align-items: flex-start;
        gap: 5px;
      }
      
      .highlight {
        min-width: 140px;
      }
      
      .actions {
        flex-direction: column;
      }
    }
    
    /* Loading animation */
    .loading {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 200px;
    }
    
    .spinner {
      width: 40px;
      height: 40px;
      border: 4px solid rgba(0, 0, 0, 0.1);
      border-radius: 50%;
      border-top: 4px solid #3498db;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* No appointments message */
    .no-appointments {
      text-align: center;
      padding: 40px;
      color: #7f8c8d;
      font-size: 18px;
    }
    
    .no-appointments i {
      font-size: 48px;
      margin-bottom: 15px;
      color: #bdc3c7;
    }
  </style>
</head>
<body>
  <nav>
    <h2><i class="fa-solid fa-user-shield"></i> Staff Panel</h2>
      <a href="/kaayakarpam/index.html"><i class="fa fa-home" aria-hidden="true"></i> Home</a>
     <a href="../jsp/staffView.jsp"><i class="fa fa-clipboard" aria-hidden="true"></i> DashBoard</a>
    <a href="../html/viewInPatients.html"><i class="fa-solid fa-bed"></i> View InPatients</a>
    <a href="../html/viewHospitalDetails.html"><i class="fa-solid fa-hospital"></i> Hospital Details</a>
    <a href="../html/viewScanAppointments.html"><i class="fa fa-calendar" aria-hidden="true"></i> Today Scan Appointments </a>
    <a href="../html/viewUpcomingScanAppointments.html"><i class="fas fa-hourglass"></i> Upcoming Scan Appointments </a>
    <a href="../html/scanAppointmentsHistory.html"><i class="fas fa-hourglass-end"></i> Scan Appointments History</a>
    <a href="../html/patientManagement.html"><i class="fa-solid fa-file-medical"></i> Patient Requests</a>
    <a href="../../common/web/html/viewProfile.html"><i class="fa-solid fa-user"></i> View Profile</a>
  </nav>
  
  <div class="main">
    <header>üóìÔ∏è Today Scan Appointments</header>
    <div class="container" id="scan-container">
      <div class="loading">
        <div class="spinner"></div>
      </div>
    </div>
    <div class="error" id="error-msg"></div>
  </div>   
  
  <script>
    async function loadScanAppointments() {
      const scanAppointmentContainer = document.getElementById("scan-container");
      const errorMsg = document.getElementById("error-msg");
      errorMsg.textContent = "";
      scanAppointmentContainer.innerHTML = "";
      
      try {
        const response = await fetch("/kaayakarpam/scanAppointments", {method: "GET"});
        if (!response.ok) {
          if (response.status === 401) {
            throw new Error("Unauthorized. Please login again.");
          } 
          else if (response.status === 404) {
            throw new Error("No Data was found for this user.");
          } 
          else {
            throw new Error("Failed to fetch Scan Appointments details.");
          }
        }
        
        const scanAppointments = await response.json();
        
        if (scanAppointments.length === 0) {
          errorMsg.textContent = "No Scan Appointments Today.";
          errorMsg.classList.add("no-appointments");
          errorMsg.innerHTML = '<i class="fas fa-calendar-times"></i><br>No Scan Appointments Today.';
          return;
        }
        
        scanAppointments.forEach(sa => {
          const card = document.createElement("div");
          card.className = "card";
          
          card.innerHTML = `
            <h2>${sa.ScanType}</h2>
            <div class="info"><span class="highlight">üë§ Patient Name:</span> ${sa.patientName}</div>
            <div class="info"><span class="highlight">üìû Phone:</span> ${sa.patientMobileNumber}</div>
            <div class="info"><span class="highlight">üîû Patient Age:</span> ${sa.patientAge}</div>
            <div class="info"><span class="highlight">‚ôÇÔ∏è/‚ôÄÔ∏è  Gender:</span> ${sa.patientGender}</div>
          <!--
            <div class="datetime">
              <div><span class="highlight">Date:</span> ${sa.appointmentDate || 'Today'}</div>
              
             <div><span class="highlight">Time:</span> ${sa.appointmentTime || 'Not specified'}</div>
            </div>
            
           <div class="status status-pending">Pending</div> 
            
            <div class="actions">
              <button class="btn btn-success"><i class="fas fa-check"></i> Confirm</button>
              <button class="btn btn-primary"><i class="fas fa-pencil-alt"></i> Reschedule</button>
              <button class="btn btn-danger"><i class="fas fa-times"></i> Cancel</button>
            </div>
             -->
          `;    
          scanAppointmentContainer.appendChild(card);
        });
      }
      catch(error) {
        errorMsg.textContent = error.message;
      }
    }
    
    window.onload = function() {
      loadScanAppointments();
    };
  </script>
</body>
</html>
